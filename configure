#!/bin/bash
DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
set -e
set -o pipefail
cd $DIR
cd build
cmake clean ../
make clean
cmake ../
make
	if [[ ":$PYTHONPATH:" != *":$DIR/build:"* ]]; then
		echo "export PYTHONPATH=$DIR/build:$PYTHONPATH" >> ~/.bashrc
		echo "export PYTHONPATH=$DIR/build:$PYTHONPATH" >> ~/.zshrc	
		echo "Please restart your bash to take effect!"  
	else
		echo "everything is done, $USER"
		echo "running tests"
		../run_tests
	fi 
